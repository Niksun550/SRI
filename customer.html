<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer - Restaurant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js"></script>
</head>
<body class="bg-gray-100">

    <!-- Navbar -->
    <header class="bg-red-600 text-white p-4 text-center">
        <h1 class="text-2xl font-bold">ğŸ½ï¸ Welcome to Our Restaurant</h1>
    </header>

    <div class="p-6">

        <!-- Table Selection -->
        <h2 class="text-xl font-bold">Select Your Table</h2>
        <select id="table-select" class="p-2 border w-full mt-2">
            <option value="Table 1">Table 1</option>
            <option value="Table 2">Table 2</option>
            <option value="Table 3">Table 3</option>
        </select>

        <!-- Menu Section -->
        <h2 class="text-xl font-bold mt-4">ğŸ“œ Menu</h2>
        <div id="menu-items" class="grid grid-cols-2 gap-4 mt-2"></div>

        <!-- Order Summary -->
        <h2 class="text-xl font-bold mt-4">ğŸ›’ Your Order</h2>
        <ul id="cart-items" class="bg-white p-4 rounded shadow mt-2"></ul>
        <button id="place-order" class="bg-green-600 text-white p-2 rounded w-full mt-2">Place Order</button>

        <!-- Order Status -->
        <h2 class="text-xl font-bold mt-4">ğŸ“¦ Order Status</h2>
        <p id="order-status" class="text-red-600 font-bold">Pending</p>

    </div>

    <script>
        // Firebase Setup
        const firebaseConfig = {
            apiKey: "AIzaSyAkwiKjPYsv4LlRQLTxH6kj15xlCnvoXKA",
            authDomain: "testmenu-4ed51.firebaseapp.com",
            projectId: "testmenu-4ed51",
            storageBucket: "testmenu-4ed51.firebasestorage.app",
            messagingSenderId: "98263305480",
            appId: "1:98263305480:web:024158941cb5f53225f0bd"
            measurementId: "G-CX0JDH1RDP"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Menu Data
        const menu = [
            { id: 1, name: "Pizza", price: 12.99, image: "https://via.placeholder.com/150" },
            { id: 2, name: "Burger", price: 9.99, image: "https://via.placeholder.com/150" },
            { id: 3, name: "Pasta", price: 8.99, image: "https://via.placeholder.com/150" },
            { id: 4, name: "Salad", price: 5.99, image: "https://via.placeholder.com/150" }
        ];

        const cart = {};

        // Load menu items dynamically
        function loadMenu() {
            let menuContainer = document.getElementById("menu-items");
            menuContainer.innerHTML = "";
            menu.forEach(item => {
                menuContainer.innerHTML += `
                    <div class="bg-white p-4 rounded-lg shadow text-center">
                        <img src="${item.image}" class="w-full h-40 object-cover rounded">
                        <h3 class="text-lg font-bold mt-2">${item.name}</h3>
                        <p class="text-gray-600">$${item.price.toFixed(2)}</p>
                        <div class="flex justify-between mt-2">
                            <button onclick="changeQuantity(${item.id}, -1)" class="bg-gray-400 text-white px-2 py-1 rounded">-</button>
                            <span id="qty-${item.id}" class="px-4">0</span>
                            <button onclick="changeQuantity(${item.id}, 1)" class="bg-red-600 text-white px-2 py-1 rounded">+</button>
                        </div>
                    </div>
                `;
            });
        }

        // Update cart quantity
        function changeQuantity(id, change) {
            if (!cart[id]) cart[id] = { ...menu.find(m => m.id === id), quantity: 0 };
            cart[id].quantity += change;
            if (cart[id].quantity < 0) cart[id].quantity = 0;

            document.getElementById(`qty-${id}`).innerText = cart[id].quantity;
            updateCart();
        }

        // Update Cart UI
        function updateCart() {
            let cartList = document.getElementById("cart-items");
            cartList.innerHTML = "";
            let total = 0;

            Object.values(cart).forEach(item => {
                if (item.quantity > 0) {
                    total += item.price * item.quantity;
                    cartList.innerHTML += `
                        <li class="flex justify-between py-2 border-b">${item.name} x${item.quantity} 
                        <span>$${(item.price * item.quantity).toFixed(2)}</span></li>
                    `;
                }
            });

            document.getElementById("place-order").innerText = `Place Order ($${total.toFixed(2)})`;
        }

        // Place order in Firebase
        async function placeOrder() {
            const table = document.getElementById("table-select").value;
            const order = {
                table,
                items: Object.values(cart).filter(i => i.quantity > 0),
                status: "Pending"
            };

            await db.collection("orders").add(order);
            alert("Order Placed Successfully!");
            for (let id in cart) cart[id].quantity = 0;
            updateCart();
        }

        // Track order status in real-time
        db.collection("orders").onSnapshot((snapshot) => {
            snapshot.docs.forEach(doc => {
                const order = doc.data();
                document.getElementById("order-status").innerText = order.status;
            });
        });

        // Initialize menu and event listeners
        document.getElementById("place-order").addEventListener("click", placeOrder);
        window.changeQuantity = changeQuantity;
        loadMenu();
    </script>

</body>
</html>
