<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Kitchen Dashboard</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    h1 { color: #444; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 10px; }
    th { background-color: #f4f4f4; }
    td pre { margin: 0; font-size: 0.9rem; }
  </style>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>

  <h1>🔥 Live Kitchen Dashboard</h1>

  <table>
    <thead>
      <tr>
        <th>Order ID</th>
        <th>Customer</th>
        <th>Items</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody id="order-table-body"></tbody>
  </table>

  <script>
    // ✅ Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAkwiKjPYsv4LlRQLTxH6kj15xlCnvoXKA",
      authDomain: "testmenu-4ed51.firebaseapp.com",
      projectId: "testmenu-4ed51",
      storageBucket: "testmenu-4ed51.appspot.com",
      messagingSenderId: "98263305480",
      appId: "1:98263305480:web:024158941cb5f53225f0bd"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const orderTableBody = document.getElementById('order-table-body');

    // 🔁 Live listener
    db.collection("orders")
      .orderBy("timestamp", "desc")
      .onSnapshot(snapshot => {
        orderTableBody.innerHTML = ''; // Clear table

        snapshot.forEach(doc => {
          const order = doc.data();

          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${doc.id}</td>
            <td>
              <strong>${order.custName}</strong><br/>
              📱 ${order.mobile}<br/>
              🪑 Table: ${order.tableNo}
            </td>
            <td>
              <pre>${order.items.map(item =>
                `${item.name} x${item.qty} = ₹${item.qty * item.price}`).join('\n')}</pre>
            </td>
            <td>${order.status || 'new'}</td>
          `;
          orderTableBody.appendChild(row);
        });
      });
  </script>

</body>
</html>
